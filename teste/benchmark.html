<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title></title>
  </head>
  <body>
    <script src="hls.js"></script>
    <video id="video" controls></video>
    <script>
      function parseQuery(queryString) {
        var query = {};
        var pairs = (
          queryString[0] === '?' ? queryString.substr(1) : queryString
        ).split('&');
        for (var i = 0; i < pairs.length; i++) {
          var pair = pairs[i].split('=');
          query[decodeURIComponent(pair[0])] = decodeURIComponent(
            pair[1] || ''
          );
        }
        return query;
      }

      /* get stream from query string */
      function getParameterByName(name) {
        var query = parseQuery(window.location.search);
        return query.hasOwnProperty(name) ? query[name] : undefined;
      }

      var stream =
        getParameterByName('stream') ||
        'https://service-stitcher.clusters.pluto.tv/stitch/hls/channel/5f357e91b18f0b00073583d2/master.m3u8?advertisingId=&appName=web&appVersion=unknown&architecture=&buildVersion=&clientTime=&deviceDNT=0&deviceId=9c0804dc98a54146bab955f119f9a09e&deviceLat=-1.3440&deviceLon=-48.3851&deviceMake=Chrome&deviceModel=Chrome&deviceType=web&deviceVersion=unknown&includeExtendedEvents=false&marketingRegion=BR&sid=19cec34c09e111ecbb4866b58672c325&userId=';
    </script>
    <script>
      if (Hls.isSupported()) {
        var video = document.getElementById('video');
        var hls = new Hls();
        hls.loadSource(stream);
        hls.attachMedia(video);
        hls.on(Hls.Events.MEDIA_ATTACHED, function () {
          video.muted = true;
          video.play();
        });
      }
    </script>
    <script>
      var video = document.getElementById('video');
      window.onload = function () {
        var i = 0;
        var el = document.getElementById('update');
        function foo() {
          i++;
          el.innerHTML =
            'animation:' +
            i +
            ',decoded:' +
            video.webkitDecodedFrameCount +
            ',dropped:' +
            video.webkitDroppedFrameCount;
          window.requestAnimationFrame(foo);
        }
        foo();
      };
    </script>
    <div id="update"></div>
  </body>
</html>
